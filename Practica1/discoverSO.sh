#!/bin/bash

if [ "$#" -ne 1 ] 
then 
    echo "Error: se requiere una direccion de red."  
    exit 1
fi

dir=$1

if [[ $dir =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]
then
    ttl=`ping -c3 $dir | grep ttl | tail -1 | awk '{print $6}' | cut -f2 -d\=`
    case $ttl in
	32 )
	    echo "$dir: Sistema operativo MacOS"
	    ;;	
	64 )
	    echo "$dir: Sistema operativo Linux/UNIX"
	    ;;
	128 ) 
	    echo "$dir: Sistema operativo Windows XP/NT/2000 o posterior"
	    ;;
	254 )
	    echo "$dir: Sistema operativo Solaris"
	    ;;
	255 )
	    echo "$dir: Sistema operativo Cisco"	
	    ;;
	* )
	    echo "$dir: Sistema operativo indeterminado"
    esac
fi

